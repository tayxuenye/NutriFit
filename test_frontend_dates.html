<!DOCTYPE html>
<html>
<head>
    <title>Test Frontend Date Logic</title>
</head>
<body>
    <h1>Frontend Date Logic Test</h1>
    <div id="output"></div>

    <script>
        // Copy the exact functions from index.html
        function getWeekStartDate(weekOffset = 0) {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday
            // Calculate days to Monday (if today is Sunday, go back 6 days)
            const daysToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
            const monday = new Date(today);
            monday.setDate(today.getDate() + daysToMonday + (weekOffset * 7));
            return monday;
        }

        function formatWeekDisplay(weekOffset) {
            const weekStart = getWeekStartDate(weekOffset);
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6);

            const startStr = weekStart.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            const endStr = weekEnd.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            if (weekOffset === 0) {
                return `This Week (${startStr} - ${endStr})`;
            } else if (weekOffset === -1) {
                return `Last Week (${startStr} - ${endStr})`;
            } else if (weekOffset === 1) {
                return `Next Week (${startStr} - ${endStr})`;
            } else {
                return `${startStr} - ${endStr}`;
            }
        }

        function getWeekValue(weekOffset) {
            const weekStart = getWeekStartDate(weekOffset);
            // Format as YYYY-MM-DD in local timezone (not UTC)
            const year = weekStart.getFullYear();
            const month = String(weekStart.getMonth() + 1).padStart(2, '0');
            const day = String(weekStart.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // Test
        const output = document.getElementById('output');
        let html = `<p><strong>Today:</strong> ${new Date().toDateString()}</p>`;
        html += `<p><strong>Day of week:</strong> ${new Date().getDay()} (0=Sunday, 1=Monday, etc.)</p>`;
        html += `<hr>`;
        
        for (let offset = -1; offset <= 1; offset++) {
            const label = offset === -1 ? 'Last Week' : offset === 0 ? 'This Week' : 'Next Week';
            html += `<h3>${label} (offset=${offset})</h3>`;
            html += `<p><strong>Display:</strong> ${formatWeekDisplay(offset)}</p>`;
            html += `<p><strong>API Value:</strong> ${getWeekValue(offset)}</p>`;
            html += `<p><strong>Monday Date Object:</strong> ${getWeekStartDate(offset).toDateString()}</p>`;
            html += `<hr>`;
        }

        output.innerHTML = html;
    </script>
</body>
</html>
