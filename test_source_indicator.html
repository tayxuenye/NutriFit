<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Source Indicator Test</title>
    <style>
        :root {
            --success: #10b981;
            --border: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 16px;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f8fafc;
        }
        
        .plan-item {
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .plan-item:hover {
            border-color: var(--success);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .plan-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xs);
        }
        
        .plan-item-name {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .plan-item-date {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .plan-item-meta {
            font-size: 0.8125rem;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <h1>Plan Source Indicator Test</h1>
    
    <h2>Meal Plans</h2>
    <div id="mealPlanList"></div>
    
    <h2>Workout Plans</h2>
    <div id="workoutPlanList"></div>
    
    <script>
        // Test data
        const mealPlans = [
            {
                id: '1',
                name: 'Weekly Plan',
                source: 'ai_chat',
                start_date: '2025-12-03',
                end_date: '2025-12-09',
                created_at: Date.now() / 1000 - 3600 // 1 hour ago
            },
            {
                id: '2',
                name: 'Weekly Plan',
                source: 'manual',
                start_date: '2025-12-10',
                end_date: '2025-12-16',
                created_at: Date.now() / 1000 - 7200 // 2 hours ago
            }
        ];
        
        const workoutPlans = [
            {
                id: '1',
                name: 'Weekly',
                source: 'ai_chat',
                start_date: '2025-12-03',
                end_date: '2025-12-09',
                workout_days_per_week: 4,
                created_at: Date.now() / 1000 - 1800 // 30 min ago
            },
            {
                id: '2',
                name: 'Weekly',
                source: 'manual',
                start_date: '2025-12-10',
                end_date: '2025-12-16',
                workout_days_per_week: 3,
                created_at: Date.now() / 1000 - 5400 // 90 min ago
            }
        ];
        
        // Render meal plans
        const mealListContainer = document.getElementById('mealPlanList');
        mealListContainer.innerHTML = mealPlans.map(plan => {
            const startDate = new Date(plan.start_date);
            const endDate = new Date(plan.end_date);
            const dateDisplay = `${startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
            
            const sourceIndicator = plan.source === 'ai_chat' ? '<span style="color: var(--success); font-size: 0.75rem; margin-left: var(--spacing-xs);">ðŸ¤– AI Chat</span>' : '';
            
            const now = new Date();
            const updatedDate = new Date(plan.created_at * 1000);
            const diffMs = now - updatedDate;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            
            let timeInfo = 'Last updated: ';
            if (diffMins < 1) timeInfo += 'Just now';
            else if (diffMins < 60) timeInfo += `${diffMins}m ago`;
            else if (diffHours < 24) timeInfo += `${diffHours}h ago`;
            
            return `
                <div class="plan-item">
                    <div class="plan-item-header">
                        <span class="plan-item-name">Weekly Plan${sourceIndicator}</span>
                        <span class="plan-item-date">${dateDisplay}</span>
                    </div>
                    <div class="plan-item-meta">${timeInfo}</div>
                </div>
            `;
        }).join('');
        
        // Render workout plans
        const workoutListContainer = document.getElementById('workoutPlanList');
        workoutListContainer.innerHTML = workoutPlans.map(plan => {
            const startDate = new Date(plan.start_date);
            const endDate = new Date(plan.end_date);
            const dateDisplay = `${startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
            
            const sourceIndicator = plan.source === 'ai_chat' ? '<span style="color: var(--success); font-size: 0.75rem; margin-left: var(--spacing-xs);">ðŸ¤– AI Chat</span>' : '';
            
            const now = new Date();
            const createdDate = new Date(plan.created_at * 1000);
            const diffMs = now - createdDate;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            
            let timeInfo = '';
            if (diffMins < 1) timeInfo = ' â€¢ Just now';
            else if (diffMins < 60) timeInfo = ` â€¢ ${diffMins}m ago`;
            else if (diffHours < 24) timeInfo = ` â€¢ ${diffHours}h ago`;
            
            return `
                <div class="plan-item">
                    <div class="plan-item-header">
                        <span class="plan-item-name">Weekly${sourceIndicator}</span>
                        <span class="plan-item-date">${dateDisplay}</span>
                    </div>
                    <div class="plan-item-meta">${plan.workout_days_per_week || 0} workout days${timeInfo}</div>
                </div>
            `;
        }).join('');
    </script>
</body>
</html>
